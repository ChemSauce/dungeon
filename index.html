function updateQuestBoardUI() {
    const questBoardContainer = document.getElementById('quest-board-container');
    if (!questBoardContainer) return; // Guard clause for container
    
    questBoardContainer.innerHTML = ''; // Clear previous quest cards

    // Guard clause for player and quests
    if (!player || !player.quests) {
        console.error('Player or player quests not initialized');
        return;
    }

    // Loop through all quests and render them for the player
    for (const [questId, questData] of Object.entries(quests)) {
        // Defensive: Always provide a fallback if quest not initialized
        const playerQuest = (player.quests[questId]) ? player.quests[questId] : {
            isAccepted: false,
            isComplete: false,
            isTurnedIn: false,
            progress: 0
        };

        // Initialize quest in player data if it doesn't exist
        if (!player.quests[questId]) {
            player.quests[questId] = { ...playerQuest };
        }

        // Determine quest status and available actions
        let statusText = '';
        let actions = [];

        if (playerQuest.isTurnedIn) {
            statusText = '<span class="text-green-400">Completed</span>';
        } else if (playerQuest.isComplete) {
            statusText = '<span class="text-yellow-400">Ready to turn in!</span>';
            actions.push({
                label: 'Turn In',
                callback: () => turnInQuest(questId)
            });
        } else if (playerQuest.isAccepted) {
            statusText = `<span class="text-blue-400">In Progress</span> (${playerQuest.progress}/${questData.goal || 1})`;
        } else {
            statusText = '<span class="text-gray-400">Not Started</span>';
            actions.push({
                label: 'Accept',
                callback: () => acceptQuest(questId)
            });
        }

        // Create the quest card UI
        const card = document.createElement('div');
        card.className = 'quest-card bg-gray-800 p-4 rounded-lg mb-4 shadow-lg';

        card.innerHTML = `
            <h3 class="text-lg font-bold mb-2">${questData.name || questId}</h3>
            <p class="text-sm mb-2">${questData.description || ''}</p>
            <div class="mb-2">${statusText}</div>
            <div class="flex space-x-2"></div>
        `;

        // Add action buttons
        const actionsContainer = card.querySelector('div.flex');
        actions.forEach(action => {
            const btn = document.createElement('button');
            btn.className = 'bg-yellow-600 hover:bg-yellow-700 text-white font-bold py-1 px-3 rounded';
            btn.textContent = action.label;
            btn.onclick = () => {
                action.callback();
                updateQuestBoardUI(); // Refresh UI after action
            };
            actionsContainer.appendChild(btn);
        });

        questBoardContainer.appendChild(card);
    }
}
